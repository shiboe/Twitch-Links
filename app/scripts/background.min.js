!function(e){var t={};function n(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxDuration=9e5},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Tab=class{constructor(e){this.tab=e,this.id=e.id,this.twitch=this.isTwitch(e),this.streamer=this.twitch?this.getStreamer(e.url):null}isTwitch(e){if(!e.url)return!1;const t=e.url.split("/")[2];return"go.twitch.tv"===t||"www.twitch.tv"===t}getStreamer(e){const t=e.split("/");return t.length>=4?t[3]:null}isActive(){return this.tab.active}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(2);t.LinkManager=class{constructor(){this.streamerLinks={},this.hiddenLinks=[],this.savedLinks=[]}add(e,t){this.streamerLinks[t]||(this.streamerLinks[t]={}),e.forEach(e=>{this.streamerLinks[t][e]=Date.now()})}hide(e){-1===this.hiddenLinks.indexOf(e)&&this.hiddenLinks.push(e)}unHide(e){const t=this.hiddenLinks.indexOf(e);t>=0&&this.hiddenLinks.splice(t,1)}save(e){-1===this.savedLinks.indexOf(e)&&this.savedLinks.push(e)}unSave(e){const t=this.savedLinks.indexOf(e);t>=0&&this.savedLinks.splice(t,1)}getLinks(e){return this.removeOldLinks(),this.streamerLinks[e]?Object.keys(this.streamerLinks[e]).map(t=>({url:t,created:this.streamerLinks[e][t],hidden:this.hiddenLinks.indexOf(t)>=0,saved:this.savedLinks.indexOf(t)>=0})):[]}getSaved(){return this.savedLinks}getHidden(){return this.hiddenLinks}getLinkCount(e){return this.streamerLinks[e]?Object.keys(this.streamerLinks[e]).length:0}removeOldLinks(){Object.keys(this.streamerLinks).forEach(e=>{Object.keys(this.streamerLinks[e]).forEach(t=>{const n=this.streamerLinks[e][t];Date.now()-n>=s.maxDuration&&delete this.streamerLinks[e][t]})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(10),i=n(9),r=new s.LinkManager;var a;chrome.runtime.onMessage.addListener((e,t,n)=>{let s=!1;if(e)switch(e.type){case"addLinks":r.add(e.links,e.streamer);break;case"hideLink":r.hide(e.link),s=!0;break;case"unHideLink":r.unHide(e.link),s=!0;break;case"saveLink":r.save(e.link),s=!0;break;case"unSaveLink":r.unSave(e.link),s=!0;break;case"unPopOverlay":return void(a=null)}const o=new i.Tab(t.tab);if(o.twitch&&o.streamer){const n=r.getLinks(o.streamer),i=e&&0===e.type.indexOf("show");chrome.tabs.sendMessage(t.tab.id,{type:i?e.type:"updateLinks",links:n,force:s,saved:r.getSaved(),hidden:r.getHidden()}),o.isActive()&&chrome.browserAction.setBadgeText({text:n.length.toString()})}}),chrome.tabs.onActivated.addListener(function(e){chrome.tabs.get(e.tabId,e=>{const t=new i.Tab(e);let n="";if(t.twitch&&t.streamer){const e=r.getLinkCount(t.streamer);e&&(n=e.toString())}chrome.browserAction.setBadgeText({text:n})})}),chrome.browserAction.onClicked.addListener(e=>{const t=new i.Tab(e),n=a;a&&(chrome.tabs.sendMessage(a,{type:"unpopOverlay"}),a=null),t.twitch&&t.streamer&&t.id!==n&&(a=t.id,chrome.tabs.sendMessage(t.id,{type:"popOverlay",links:r.getLinks(t.streamer)}))})}]);